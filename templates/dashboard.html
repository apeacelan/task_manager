{% extends 'base.html' %}
{% block content %}
<div class="row align-items-center mb-4">
    <div class="col-6"><h3>Dashboard</h3></div>
    <div class="col-6 text-end text-muted small">Current Date: {{ today.strftime('%d %b %Y') }}</div>
</div>

<div class="row">
    <div class="col-lg-4">
        <div class="card p-3 shadow-sm">
            <h6 class="fw-bold mb-3"><i class="fas fa-plus-circle text-primary me-2"></i>Quick Task Add</h6>
            <form action="/task/add" method="POST">
                <input type="text" name="title" class="form-control mb-2" placeholder="Task name..." required>
                <div class="row g-2 mb-2">
                    <div class="col-6">
                        <select name="priority" class="form-select small">
                            <option value="High">High</option>
                            <option value="Medium">Medium</option>
                            <option value="Low">Low</option>
                        </select>
                    </div>
                    <div class="col-6">
                        <select name="category_id" class="form-select small">
                            <option value="">No Category</option>
                            {% for cat in categories %}<option value="{{ cat.id }}">{{ cat.name }}</option>{% endfor %}
                        </select>
                    </div>
                </div>
                <input type="date" name="deadline" class="form-control mb-3" value="2026-02-10">
                <button type="submit" class="btn btn-primary w-100">Add Task +</button>
            </form>
        </div>

        <div class="card p-3 shadow-sm">
            <h6 class="fw-bold mb-3"><i class="fas fa-folder-plus text-primary me-2"></i>Category Importance</h6>
            <form action="/category/add" method="POST">
                <input type="text" name="name" class="form-control mb-2" placeholder="Category Name" required>
                <div class="mb-3 text-center">
                    <label class="small text-muted d-block mb-1">Weight (1-10)</label>
                    <input type="range" name="weight" class="form-range" min="1" max="10" step="1">
                </div>
                <button type="submit" class="btn btn-outline-primary btn-sm w-100">Create Category</button>
            </form>
        </div>
    </div>

    <div class="col-lg-8">
        <div class="card shadow-sm">
            <div class="card-body">
                <h6 class="fw-bold mb-3 text-primary">Priority Queue</h6>
                <div class="table-responsive">
                    <table class="table table-hover align-middle" style="font-size: 0.9rem;">
                        <thead class="bg-light">
                            <tr>
                                <th>Task Title</th>
                                <th>Deadline</th>
                                <th>Status</th>
                                <th class="text-end">Urgency</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for task in tasks %}
                            <tr>
                                <td class="fw-bold">{{ task.title }}</td>
                                <td>{{ task.deadline }}</td>
                                <td>
                                    {% if task.overdue %}
                                        <span class="status-dot dot-gray"></span> Overdue
                                    {% elif task.urgency > 70 %}
                                        <span class="status-dot dot-red"></span> Critical
                                    {% elif task.urgency > 30 %}
                                        <span class="status-dot dot-yellow"></span> Soon
                                    {% else %}
                                        <span class="status-dot dot-green"></span> OK
                                    {% endif %}
                                </td>
                                <td class="text-end fw-bold text-primary">{{ task.urgency }}</td>
                            </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}